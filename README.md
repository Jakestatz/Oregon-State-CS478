# Oregon-State-CS78
﻿
Project A: TCP Attacks
TCP (Transmission Control Protocol) is the main transport layer protocol of the network protocol suite. In the original TCP designs, the focus was mostly on providing reliable and in-order, end-to-end delivery, but not on the security aspects. The aim of this project is to exploit TCP vulnerabilities to launch and demonstrate attacks on TCP. TCP has been studied extensively in ECE/CS 372, and if you need a refresher and/or are not familiar with it, you should do so before proceeding with the project. Lots of resources are available online and on textbooks, including 372 materials, explaining how TCP works. Below we provide some basic information, mostly focusing on the description of the attacks on TCP, to get you started on the project. Further study and research are required from your side.
1. TCP's three-way handshake
Before a TCP connection is established, a three-handshake message exchange between the two entities is required, which is a set of three messages exchanged between the client and the server: (i) client sends a SYN message to the Server, indicating desire for establishing a TCP session; (ii) Server replies with a SNY-ACK message acknowledging/approving the session establishment, and (iii) the client replying back with an ACK message.
2. Attacks to be studied in the project
In this project, you will be creating various attacking scenarios to exploit the vulnerabilities of TCP's three-way handshake mechanism described above and other TCP mechanisms. You will be designing and creating your own virtual networks (using the Docker technology learned in Preparation Phase of the project) to launch and validate these attacks. You will also be using scapy to emulate and enable the attacks. The following are some of the attacks that need to be considered in this project. In addition to these, you are encouraged to consider and study other possible attacks that exploit TCP vulnerabilities.
→ TCP SYN Flooding Attack: An attacker sends many TCP SYN messages to a victim machine (e.g., webserver listening on port 80) but with no intention to reply with ACKS to the server's SYNACKs. For this, the attacker could use spoofed IP addresses. By intentionally not replying to all these SYNACK, the attacker forces the server to keep many connections half-opened, each of which requires the server to store some (connection) information (e.g., initial sequence numbers, max segment size, receiver buffer size, etc.). This will make the server's buffer full, resulting in rejecting any legitimate requests for connections. For this attack, you may need to turn off SYN Cookie, a countermeasure technique for addressing TCP SYN flooding.
→ TCP RST Attack: In normal situations, when a machine receives an unexpected TCP segment (e.g., receives a TCP SYN message requesting to establish a TCP connection to a port that the machine is not accepting connections on), the receiving machine sends back a special segment, called TCP RST (reset) message, to the sender instructing it to stop sending. This is a control segment with no payload and with the RST bit set. A TCP RST attack exploits this mechanism to fool two victim machines, with an active TCP connection between them, into closing the connection, thereby stopping the data transfer between the machines. The attacker does so by crafting and sending one (or both) of the victim machines a fake TCP RST segment, instructing the closure of the TCP connection. For this attack to succeed, the sequence number of the spoofed TCP RST segment must be carefully chosen, so that it matches the receiver's (i.e., victim's) expected sequence number (or fall within the receiver's sliding window in some implementation). You need to demonstrate the success of the attack by establishing some connection (e.g., Telnet or SSH session) and then terminating the session through spoofed RST segments. A nice introduction to this attack (as well as related TCP operations/features), given by Robert Heaton, can be found here.
→ TCP Session Hijacking: An attacker can hijack an existing TCP connection by taking over the connection and injecting its own traffic. For example, the attacker can fool the server of ongoing Telnet connection between a client and a server to run some commands of its own choice. Recall that a TCP connection/session is uniquely identified by the 4-tuple: source IP address, source port number, destination IP address, and destination port number. Therefore, an attacker can spoof a TCP segment with the 4-tuple matching that of an existing TCP session and send it to the receiver. The receiver will have no way to tell whether this segment is coming from the legitimate sender or from an attacker. For this, the attacker will have to sniff at an existing TCP session to obtain its 4-tuple elements as well as the receiver's expected sequence number, and use them to craft a valid TCP segment of its own. Note here that if the sequence number is not set to the right one (i.e., the one expected by the receiver), the receiver may discard the spoofed segment.
3. Defense techniques (Bonus task for earning extra points on the project)
As an optional (bonus) task, each team is encouraged to investigate defense strategies to defend against one (or more) of these studied attacks. This requires researching some of the existing defense approaches, implementing them using the created virtual networks, and demonstrating how the defense approach(es) can mitigate the attack. Make sure to clearly mention this in the final report to earn extra credits.
4. Deliverable and submissions
Each team/project has two deliverables: Demo/presentation:
Each team needs to carefully design and create virtual network scenarios (using Docker containers) to launch and demonstrate the success of each of the studied attack in great details. Each team is required to prepare a presentation to show the project implementation and demonstrate the various studied attacks to the rest of the class. Details regarding the virtual network scenarios to be created for each attack, the application/session to be established between end-to-end devices, the exploitation/effects of the attack, etc. are left for each team to determine and illustrate. The demo/presentation should include some visuals and examples to best illustrate and demonstrate the studied attacks. Refer to the Project Presentation Assignment for further details.
. Final project report:
Each team needs to submit a detailed report of the project. Details, such as the code developed for the project, screenshots needed to describe the various scenarios and illustrate the success of the launched attacks, the virtual networks/topologies created to emulate the attacks, explanations of the observed behaviors to illustrate the attacks, need to be included in the report. It is highly expected that each team will put a great amount of effort and time to organize and structure the report to make it readable. Simply reporting results and screenshots without well-throughout explanations and structured writing will not earn you credits for the report. Refer to the Project Final Report Assignment for further details.
